<div class="xsmall-container pt-5">
  <div class="row">
    <div class="col-8">
      <div class = "d-flex justify-content-left dashboard-buttons">
        <a href="freelancer?status=currently" class="btn btn-ghost"><%="En cours "%><i class="far fa-calendar"></i></a>
        <a href="freelancer?status=history" class="btn btn-ghost"><%="Passées "%><i class="fas fa-history"></i></a>
        <a href="freelancer?status=rejected" class="btn btn-ghost"><%="En attente "%><i class="far fa-clock"></i></a>
      </div>
    </div>

    <div class="col-4">
      <div class = "container d-flex justify-content-center pb-5">
        <%= simple_form_for(:query, method: "GET", html: { class: 'inline d-flex align-content-center rounded' }) do |f| %>
        <%= f.input "", required: false, wrapper_html: { class: 'float-container', style:"width:300px" }, input_html: {value: "", placeholder: "Ex : nom de la mission, du client...", id: "left-corner-input"} %>
        <button type="submit" id="search-btn" title="" class="float-container">
          <i class="fas fa-search"></i>
        </button>
        <% end %>
      </div>
    </div>
  </div>
  <div class="row">
    <div class="col-12">
      <div class="card_container">
        <% @bookings.each do |booking| %>
          <div class="card-product">
            <p>En cours</p>
            <div class="card-information" >
              <div class="card-description">
                <% if booking.mission.photos.attached? %>
                  <%= cl_image_tag booking.mission.photos.first.key, widht: "100%" %>
                <% else %>
                  <%= image_tag("mission.jpg") %>
                <% end %>
                <h6 class="center-item"><%=booking.mission.name %></h5>
              </div>
              <div class="card-user">
                <div class="card-user_description">
                  <div style = "margin-right: 40px">
                  <ul style="list-style-type:none;" >
                    <li><strong>Client :</strong></li>
                    <li><%= link_to booking.mission.user.company_name, "#" %></li>
                    <li>Mail : <%= booking.mission.user.email %></li>
                    <li>Tél : <%= booking.mission.user.phone_number %></li>
                    <li> Adresse : <%= booking.mission.address %></li>
                  </ul>
                  </div>
                </div>
                <div class="card-user_description">
                  <ul style="list-style-type:none;">
                    <li><strong>Détails :</strong></li>
                    <li>Date de début de mission : <%= booking.mission.start_date_time %></li>
                    <li>Date de fin de mission : <%= booking.mission.end_date_time %></li>
                    <li>Statut de la mission : <%= booking.accepted %></li>
                    <li>Solde TTC : <strong><%= booking.total_price %>EUR</strong></li>
                    </ul>
                </div>

                <div>
                  <ul style="list-style-type:none; margin-top:10px">
                  <li><a href="#" class="btn btn-ok" style="margin-bottom:10px; width:140px">Facture</a></li>
                  <li><a href="#" class="btn btn-ok" style="margin-bottom:20px; width:140px">Détails</a></li>
                  <% if !booking.freelancer_review.nil? %>
                    <li><button type="button" class="btn btn-success text-center mt-2 mb-4 center-item" style="margin-right: 10px; width:140px" data-toggle="modal" data-target="#exampleModal">Donner un avis !</button></li>

                    <div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
                    <div class="modal-dialog modal-lg" role="document">
                      <div class="modal-content">
                        <div class="modal-header">
                          <div class="d-flex">
                            <div>
                                <% if booking.mission.user.avatar.attached? %>
                                  <%= cl_image_tag booking.mission.user.avatar.key ,class:"avatar-xlarge"%>
                                <% else %>
                                  <img src="https://d2mp1cia79qmhd.cloudfront.net/prod/assets/default-avatar-58953c9e3461a05e47397bef0ad1e1967f9be436996e40fc7a84147336fd23e6.png" class="avatar-large">
                                <% end %>
                            </div>
                            <h5 class="modal-title mt-2 ml-2" id="exampleModalLabel"><%= "Qu'avez-vous pensé devotre mission chez #{booking.mission.user.company_name}"%></h5>

                          </div>
                          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                          </button>
                        </div>
                        <div class="modal-body">
                          <%= simple_form_for(booking) do |f| %>
                            <%= f.input :freelancer_review %>
                            <%= f.input :freelancer_rating, collection: 1..5 %>
                            <%= f.submit %>
                          <% end %>
                        </div>
                      <div class="modal-footer">
                        <button type="button" class="btn btn-primary">Save changes</button>
                      </div>
                    </div>
                  </div>
                  </div>
                 <% end %>
                  </ul>
                </div>
              </div>
            </div>
          </div>
        <% end %>
      </div>
    </div>
  </div>
</div>
